From f16713cdafdd6fc8e22230d68a7ba75c604396f3 Mon Sep 17 00:00:00 2001
From: ci7lus <7887955+ci7lus@users.noreply.github.com>
Date: Tue, 3 Feb 2026 00:39:08 +0900
Subject: [PATCH] demux/mpeg: Print logs

---
 modules/demux/mpeg/ts.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/modules/demux/mpeg/ts.c b/modules/demux/mpeg/ts.c
index ac098e8c0c..e005716079 100644
--- a/modules/demux/mpeg/ts.c
+++ b/modules/demux/mpeg/ts.c
@@ -934,12 +934,14 @@ static int Control( demux_t *p_demux, int i_query, va_list args )
             time_t i_time, i_length;
             if( !EITCurrentEventTime( p_pmt, p_sys, &i_time, &i_length ) && i_length > 0 )
             {
+                msg_Dbg( p_demux, "DEMUX_GET_POSITION: using EIT-based position" );
                 *pf = (double)i_time/(double)i_length;
                 return VLC_SUCCESS;
             }
         }
 
         if( !p_sys->b_ignore_time_for_positions &&
+             p_sys->b_canfastseek &&
              p_pmt &&
              p_pmt->pcr.i_first != VLC_TICK_INVALID &&
              p_pmt->i_last_dts != VLC_TICK_INVALID &&
@@ -950,6 +952,7 @@ static int Control( demux_t *p_demux, int i_query, va_list args )
             double i_pos = p_pmt->pcr.i_current - p_pmt->pcr.i_first;
             if( i_length > 0 )
             {
+                msg_Dbg( p_demux, "DEMUX_GET_POSITION: using PCR/DTS-based position" );
                 *pf = i_pos / i_length;
                 return VLC_SUCCESS;
             }
@@ -958,6 +961,7 @@ static int Control( demux_t *p_demux, int i_query, va_list args )
         if( vlc_stream_GetSize( p_sys->stream, &u64 ) == VLC_SUCCESS )
         {
             uint64_t offset = vlc_stream_Tell( p_sys->stream );
+            msg_Dbg( p_demux, "DEMUX_GET_POSITION: using byte-based position" );
             *pf = (double)offset / (double)u64;
             return VLC_SUCCESS;
         }
@@ -1051,6 +1055,7 @@ static int Control( demux_t *p_demux, int i_query, va_list args )
             time_t i_event_start;
             if( !EITCurrentEventTime( p_pmt, p_sys, &i_event_start, NULL ) )
             {
+                msg_Dbg( p_demux, "DEMUX_GET_TIME: using EIT-based time" );
                 *va_arg( args, vlc_tick_t * ) = vlc_tick_from_sec( i_event_start );
                 return VLC_SUCCESS;
             }
@@ -1058,6 +1063,7 @@ static int Control( demux_t *p_demux, int i_query, va_list args )
 
         if( p_pmt && p_pmt->pcr.i_current != VLC_TICK_INVALID && p_pmt->pcr.i_first != VLC_TICK_INVALID )
         {
+            msg_Dbg( p_demux, "DEMUX_GET_TIME: using PCR-based time" );
             *va_arg( args, vlc_tick_t * ) = p_pmt->pcr.i_current - p_pmt->pcr.i_first;
             return VLC_SUCCESS;
         }
-- 
2.39.1


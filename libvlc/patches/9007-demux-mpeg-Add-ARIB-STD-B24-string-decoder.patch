From 9e5d3aca812f326bc2d3bbf1508a8f863e07f6c0 Mon Sep 17 00:00:00 2001
From: ci7lus <7887955+ci7lus@users.noreply.github.com>
Date: Sat, 14 Feb 2026 22:14:21 +0900
Subject: [PATCH 9007/9014] demux/mpeg: Add ARIB-STD-B24 string decoder

---
 modules/demux/mpeg/arib_tables.h | 840 +++++++++++++++++++++++++++++++
 modules/demux/mpeg/ts_arib.c     | 448 +++++++++++++++++
 modules/demux/mpeg/ts_arib.h     |   2 +
 modules/demux/mpeg/ts_si.c       |   5 +-
 4 files changed, 1294 insertions(+), 1 deletion(-)
 create mode 100644 modules/demux/mpeg/arib_tables.h

diff --git a/modules/demux/mpeg/arib_tables.h b/modules/demux/mpeg/arib_tables.h
new file mode 100644
index 0000000000..d47df353d5
--- /dev/null
+++ b/modules/demux/mpeg/arib_tables.h
@@ -0,0 +1,840 @@
+/*
+ * SPDX-FileCopyrightText: 2015-2016 rndomhack
+ * SPDX-License-Identifier: MIT
+ * https://github.com/Chinachu/node-aribts
+ */
+
+/* Generated ARIB B24 Tables */
+#include <stdint.h>
+#include <stdlib.h>
+
+typedef struct { uint8_t key; uint8_t val[2]; } arib_map_sjis_t;
+static const arib_map_sjis_t arib_ascii_map[] = {
+    { 33, { 129, 73 } },
+    { 34, { 129, 104 } },
+    { 35, { 129, 148 } },
+    { 36, { 129, 144 } },
+    { 37, { 129, 147 } },
+    { 38, { 129, 149 } },
+    { 39, { 129, 102 } },
+    { 40, { 129, 105 } },
+    { 41, { 129, 106 } },
+    { 42, { 129, 150 } },
+    { 43, { 129, 123 } },
+    { 44, { 129, 67 } },
+    { 45, { 129, 124 } },
+    { 46, { 129, 68 } },
+    { 47, { 129, 94 } },
+    { 48, { 130, 79 } },
+    { 49, { 130, 80 } },
+    { 50, { 130, 81 } },
+    { 51, { 130, 82 } },
+    { 52, { 130, 83 } },
+    { 53, { 130, 84 } },
+    { 54, { 130, 85 } },
+    { 55, { 130, 86 } },
+    { 56, { 130, 87 } },
+    { 57, { 130, 88 } },
+    { 58, { 129, 70 } },
+    { 59, { 129, 71 } },
+    { 60, { 129, 131 } },
+    { 61, { 129, 129 } },
+    { 62, { 129, 132 } },
+    { 63, { 129, 72 } },
+    { 64, { 129, 151 } },
+    { 65, { 130, 96 } },
+    { 66, { 130, 97 } },
+    { 67, { 130, 98 } },
+    { 68, { 130, 99 } },
+    { 69, { 130, 100 } },
+    { 70, { 130, 101 } },
+    { 71, { 130, 102 } },
+    { 72, { 130, 103 } },
+    { 73, { 130, 104 } },
+    { 74, { 130, 105 } },
+    { 75, { 130, 106 } },
+    { 76, { 130, 107 } },
+    { 77, { 130, 108 } },
+    { 78, { 130, 109 } },
+    { 79, { 130, 110 } },
+    { 80, { 130, 111 } },
+    { 81, { 130, 112 } },
+    { 82, { 130, 113 } },
+    { 83, { 130, 114 } },
+    { 84, { 130, 115 } },
+    { 85, { 130, 116 } },
+    { 86, { 130, 117 } },
+    { 87, { 130, 118 } },
+    { 88, { 130, 119 } },
+    { 89, { 130, 120 } },
+    { 90, { 130, 121 } },
+    { 91, { 129, 109 } },
+    { 92, { 129, 143 } },
+    { 93, { 129, 110 } },
+    { 94, { 129, 79 } },
+    { 95, { 129, 81 } },
+    { 96, { 129, 101 } },
+    { 97, { 130, 129 } },
+    { 98, { 130, 130 } },
+    { 99, { 130, 131 } },
+    { 100, { 130, 132 } },
+    { 101, { 130, 133 } },
+    { 102, { 130, 134 } },
+    { 103, { 130, 135 } },
+    { 104, { 130, 136 } },
+    { 105, { 130, 137 } },
+    { 106, { 130, 138 } },
+    { 107, { 130, 139 } },
+    { 108, { 130, 140 } },
+    { 109, { 130, 141 } },
+    { 110, { 130, 142 } },
+    { 111, { 130, 143 } },
+    { 112, { 130, 144 } },
+    { 113, { 130, 145 } },
+    { 114, { 130, 146 } },
+    { 115, { 130, 147 } },
+    { 116, { 130, 148 } },
+    { 117, { 130, 149 } },
+    { 118, { 130, 150 } },
+    { 119, { 130, 151 } },
+    { 120, { 130, 152 } },
+    { 121, { 130, 153 } },
+    { 122, { 130, 154 } },
+    { 123, { 129, 111 } },
+    { 124, { 129, 98 } },
+    { 125, { 129, 112 } },
+    { 126, { 129, 80 } },
+};
+static const size_t arib_ascii_map_count = 94;
+
+static const arib_map_sjis_t arib_hiragana_map[] = {
+    { 33, { 130, 159 } },
+    { 34, { 130, 160 } },
+    { 35, { 130, 161 } },
+    { 36, { 130, 162 } },
+    { 37, { 130, 163 } },
+    { 38, { 130, 164 } },
+    { 39, { 130, 165 } },
+    { 40, { 130, 166 } },
+    { 41, { 130, 167 } },
+    { 42, { 130, 168 } },
+    { 43, { 130, 169 } },
+    { 44, { 130, 170 } },
+    { 45, { 130, 171 } },
+    { 46, { 130, 172 } },
+    { 47, { 130, 173 } },
+    { 48, { 130, 174 } },
+    { 49, { 130, 175 } },
+    { 50, { 130, 176 } },
+    { 51, { 130, 177 } },
+    { 52, { 130, 178 } },
+    { 53, { 130, 179 } },
+    { 54, { 130, 180 } },
+    { 55, { 130, 181 } },
+    { 56, { 130, 182 } },
+    { 57, { 130, 183 } },
+    { 58, { 130, 184 } },
+    { 59, { 130, 185 } },
+    { 60, { 130, 186 } },
+    { 61, { 130, 187 } },
+    { 62, { 130, 188 } },
+    { 63, { 130, 189 } },
+    { 64, { 130, 190 } },
+    { 65, { 130, 191 } },
+    { 66, { 130, 192 } },
+    { 67, { 130, 193 } },
+    { 68, { 130, 194 } },
+    { 69, { 130, 195 } },
+    { 70, { 130, 196 } },
+    { 71, { 130, 197 } },
+    { 72, { 130, 198 } },
+    { 73, { 130, 199 } },
+    { 74, { 130, 200 } },
+    { 75, { 130, 201 } },
+    { 76, { 130, 202 } },
+    { 77, { 130, 203 } },
+    { 78, { 130, 204 } },
+    { 79, { 130, 205 } },
+    { 80, { 130, 206 } },
+    { 81, { 130, 207 } },
+    { 82, { 130, 208 } },
+    { 83, { 130, 209 } },
+    { 84, { 130, 210 } },
+    { 85, { 130, 211 } },
+    { 86, { 130, 212 } },
+    { 87, { 130, 213 } },
+    { 88, { 130, 214 } },
+    { 89, { 130, 215 } },
+    { 90, { 130, 216 } },
+    { 91, { 130, 217 } },
+    { 92, { 130, 218 } },
+    { 93, { 130, 219 } },
+    { 94, { 130, 220 } },
+    { 95, { 130, 221 } },
+    { 96, { 130, 222 } },
+    { 97, { 130, 223 } },
+    { 98, { 130, 224 } },
+    { 99, { 130, 225 } },
+    { 100, { 130, 226 } },
+    { 101, { 130, 227 } },
+    { 102, { 130, 228 } },
+    { 103, { 130, 229 } },
+    { 104, { 130, 230 } },
+    { 105, { 130, 231 } },
+    { 106, { 130, 232 } },
+    { 107, { 130, 233 } },
+    { 108, { 130, 234 } },
+    { 109, { 130, 235 } },
+    { 110, { 130, 236 } },
+    { 111, { 130, 237 } },
+    { 112, { 130, 238 } },
+    { 113, { 130, 239 } },
+    { 114, { 130, 240 } },
+    { 115, { 130, 241 } },
+    { 116, { 129, 64 } },
+    { 117, { 129, 64 } },
+    { 118, { 129, 64 } },
+    { 119, { 129, 84 } },
+    { 120, { 129, 85 } },
+    { 121, { 129, 91 } },
+    { 122, { 129, 66 } },
+    { 123, { 129, 117 } },
+    { 124, { 129, 118 } },
+    { 125, { 129, 65 } },
+    { 126, { 129, 69 } },
+};
+static const size_t arib_hiragana_map_count = 94;
+
+static const arib_map_sjis_t arib_katakana_map[] = {
+    { 33, { 131, 64 } },
+    { 34, { 131, 65 } },
+    { 35, { 131, 66 } },
+    { 36, { 131, 67 } },
+    { 37, { 131, 68 } },
+    { 38, { 131, 69 } },
+    { 39, { 131, 70 } },
+    { 40, { 131, 71 } },
+    { 41, { 131, 72 } },
+    { 42, { 131, 73 } },
+    { 43, { 131, 74 } },
+    { 44, { 131, 75 } },
+    { 45, { 131, 76 } },
+    { 46, { 131, 77 } },
+    { 47, { 131, 78 } },
+    { 48, { 131, 79 } },
+    { 49, { 131, 80 } },
+    { 50, { 131, 81 } },
+    { 51, { 131, 82 } },
+    { 52, { 131, 83 } },
+    { 53, { 131, 84 } },
+    { 54, { 131, 85 } },
+    { 55, { 131, 86 } },
+    { 56, { 131, 87 } },
+    { 57, { 131, 88 } },
+    { 58, { 131, 89 } },
+    { 59, { 131, 90 } },
+    { 60, { 131, 91 } },
+    { 61, { 131, 92 } },
+    { 62, { 131, 93 } },
+    { 63, { 131, 94 } },
+    { 64, { 131, 95 } },
+    { 65, { 131, 96 } },
+    { 66, { 131, 97 } },
+    { 67, { 131, 98 } },
+    { 68, { 131, 99 } },
+    { 69, { 131, 100 } },
+    { 70, { 131, 101 } },
+    { 71, { 131, 102 } },
+    { 72, { 131, 103 } },
+    { 73, { 131, 104 } },
+    { 74, { 131, 105 } },
+    { 75, { 131, 106 } },
+    { 76, { 131, 107 } },
+    { 77, { 131, 108 } },
+    { 78, { 131, 109 } },
+    { 79, { 131, 110 } },
+    { 80, { 131, 111 } },
+    { 81, { 131, 112 } },
+    { 82, { 131, 113 } },
+    { 83, { 131, 114 } },
+    { 84, { 131, 115 } },
+    { 85, { 131, 116 } },
+    { 86, { 131, 117 } },
+    { 87, { 131, 118 } },
+    { 88, { 131, 119 } },
+    { 89, { 131, 120 } },
+    { 90, { 131, 121 } },
+    { 91, { 131, 122 } },
+    { 92, { 131, 123 } },
+    { 93, { 131, 124 } },
+    { 94, { 131, 125 } },
+    { 95, { 131, 126 } },
+    { 96, { 131, 128 } },
+    { 97, { 131, 129 } },
+    { 98, { 131, 130 } },
+    { 99, { 131, 131 } },
+    { 100, { 131, 132 } },
+    { 101, { 131, 133 } },
+    { 102, { 131, 134 } },
+    { 103, { 131, 135 } },
+    { 104, { 131, 136 } },
+    { 105, { 131, 137 } },
+    { 106, { 131, 138 } },
+    { 107, { 131, 139 } },
+    { 108, { 131, 140 } },
+    { 109, { 131, 141 } },
+    { 110, { 131, 142 } },
+    { 111, { 131, 143 } },
+    { 112, { 131, 144 } },
+    { 113, { 131, 145 } },
+    { 114, { 131, 146 } },
+    { 115, { 131, 147 } },
+    { 116, { 131, 148 } },
+    { 117, { 131, 149 } },
+    { 118, { 131, 150 } },
+    { 119, { 129, 82 } },
+    { 120, { 129, 83 } },
+    { 121, { 129, 91 } },
+    { 122, { 129, 66 } },
+    { 123, { 129, 117 } },
+    { 124, { 129, 118 } },
+    { 125, { 129, 65 } },
+    { 126, { 129, 69 } },
+};
+static const size_t arib_katakana_map_count = 94;
+
+typedef struct { uint16_t key; const char *val; } arib_map_str_t;
+static const arib_map_str_t arib_gaiji_map[] = {
+    { 29985, "\xe3\x90\x82" },
+    { 29986, "\xf0\xa0\x85\x98" },
+    { 29987, "\xe4\xbb\xbd" },
+    { 29988, "\xe4\xbb\xbf" },
+    { 29989, "\xe4\xbe\x9a" },
+    { 29990, "\xe4\xbf\x89" },
+    { 29991, "\xe5\x82\x9c" },
+    { 29992, "\xe5\x84\x9e" },
+    { 29993, "\xe5\x86\xbc" },
+    { 29994, "\xe3\x94\x9f" },
+    { 29995, "\xe5\x8c\x87" },
+    { 29996, "\xe5\x8d\xa1" },
+    { 29997, "\xe5\x8d\xac" },
+    { 29998, "\xe8\xa9\xb9" },
+    { 29999, "\xf0\xa0\xae\xb7" },
+    { 30000, "\xe5\x91\x8d" },
+    { 30001, "\xe5\x92\x96" },
+    { 30002, "\xe5\x92\x9c" },
+    { 30003, "\xe5\x92\xa9" },
+    { 30004, "\xe5\x94\x8e" },
+    { 30005, "\xe5\x95\x8a" },
+    { 30006, "\xe5\x99\xb2" },
+    { 30007, "\xe5\x9b\xa4" },
+    { 30008, "\xe5\x9c\xb3" },
+    { 30009, "\xe5\x9c\xb4" },
+    { 30010, "\xef\xa8\x90" },
+    { 30011, "\xe5\xa2\x80" },
+    { 30012, "\xe5\xa7\xa4" },
+    { 30013, "\xe5\xa8\xa3" },
+    { 30014, "\xe5\xa9\x95" },
+    { 30015, "\xe5\xaf\xac" },
+    { 30016, "\xef\xa8\x91" },
+    { 30017, "\xe3\x9f\xa2" },
+    { 30018, "\xe5\xba\xac" },
+    { 30019, "\xe5\xbc\xb4" },
+    { 30020, "\xe5\xbd\x85" },
+    { 30021, "\xe5\xbe\xb7" },
+    { 30022, "\xe6\x80\x97" },
+    { 30023, "\xef\xa9\xab" },
+    { 30024, "\xe6\x84\xb0" },
+    { 30025, "\xe6\x98\xa4" },
+    { 30026, "\xe6\x9b\x88" },
+    { 30027, "\xe6\x9b\x99" },
+    { 30028, "\xe6\x9b\xba" },
+    { 30029, "\xe6\x9b\xbb" },
+    { 30030, "\xe6\xa1\x92" },
+    { 30031, "\xe9\xbf\x84" },
+    { 30032, "\xe6\xa4\x91" },
+    { 30033, "\xe6\xa4\xbb" },
+    { 30034, "\xe6\xa9\x85" },
+    { 30035, "\xe6\xaa\x91" },
+    { 30036, "\xe6\xab\x9b" },
+    { 30037, "\xf0\xa3\x8f\x8c" },
+    { 30038, "\xf0\xa3\x8f\xbe" },
+    { 30039, "\xf0\xa3\x97\x84" },
+    { 30040, "\xe6\xaf\xb1" },
+    { 30041, "\xe6\xb3\xa0" },
+    { 30042, "\xe6\xb4\xae" },
+    { 30043, "\xef\xa9\x85" },
+    { 30044, "\xe6\xb6\xbf" },
+    { 30045, "\xe6\xb7\x8a" },
+    { 30046, "\xe6\xb7\xb8" },
+    { 30047, "\xef\xa9\x86" },
+    { 30048, "\xe6\xbd\x9e" },
+    { 30049, "\xe6\xbf\xb9" },
+    { 30050, "\xe7\x81\xa4" },
+    { 30051, "\xef\xa9\xac" },
+    { 30052, "\xf0\xa4\x8b\xae" },
+    { 30053, "\xe7\x85\x87" },
+    { 30054, "\xe7\x87\x81" },
+    { 30055, "\xe7\x88\x80" },
+    { 30056, "\xe7\x8e\x9f" },
+    { 30057, "\xe7\x8e\xa8" },
+    { 30058, "\xe7\x8f\x89" },
+    { 30059, "\xe7\x8f\x96" },
+    { 30060, "\xe7\x90\x9b" },
+    { 30061, "\xe7\x90\xa1" },
+    { 30062, "\xef\xa9\x8a" },
+    { 30063, "\xe7\x90\xa6" },
+    { 30064, "\xe7\x90\xaa" },
+    { 30065, "\xe7\x90\xac" },
+    { 30066, "\xe7\x90\xb9" },
+    { 30067, "\xe7\x91\x8b" },
+    { 30068, "\xe3\xbb\x9a" },
+    { 30069, "\xe7\x95\xb5" },
+    { 30070, "\xe7\x96\x81" },
+    { 30071, "\xe7\x9d\xb2" },
+    { 30072, "\xe4\x82\x93" },
+    { 30073, "\xe7\xa3\x88" },
+    { 30074, "\xe7\xa3\xa0" },
+    { 30075, "\xe7\xa5\x87" },
+    { 30076, "\xe7\xa6\xae" },
+    { 30077, "\xe9\xbf\x86" },
+    { 30078, "\xe4\x84\x83" },
+    { 30241, "\xe9\xbf\x85" },
+    { 30242, "\xe7\xa7\x9a" },
+    { 30243, "\xe7\xa8\x9e" },
+    { 30244, "\xe7\xad\xbf" },
+    { 30245, "\xe7\xb0\xb1" },
+    { 30246, "\xe4\x89\xa4" },
+    { 30247, "\xe7\xb6\x8b" },
+    { 30248, "\xe7\xbe\xa1" },
+    { 30249, "\xe8\x84\x98" },
+    { 30250, "\xe8\x84\xba" },
+    { 30251, "\xef\xa9\xad" },
+    { 30252, "\xe8\x8a\xae" },
+    { 30253, "\xe8\x91\x9b" },
+    { 30254, "\xe8\x93\x9c" },
+    { 30255, "\xe8\x93\xac" },
+    { 30256, "\xe8\x95\x99" },
+    { 30257, "\xe8\x97\x8e" },
+    { 30258, "\xe8\x9d\x95" },
+    { 30259, "\xe8\x9f\xac" },
+    { 30260, "\xe8\xa0\x8b" },
+    { 30261, "\xe8\xa3\xb5" },
+    { 30262, "\xe8\xa7\x92" },
+    { 30263, "\xe8\xab\xb6" },
+    { 30264, "\xe8\xb7\x8e" },
+    { 30265, "\xe8\xbe\xbb" },
+    { 30266, "\xe8\xbf\xb6" },
+    { 30267, "\xe9\x83\x9d" },
+    { 30268, "\xe9\x84\xa7" },
+    { 30269, "\xe9\x84\xad" },
+    { 30270, "\xe9\x86\xb2" },
+    { 30271, "\xe9\x88\xb3" },
+    { 30272, "\xe9\x8a\x88" },
+    { 30273, "\xe9\x8c\xa1" },
+    { 30274, "\xe9\x8d\x88" },
+    { 30275, "\xe9\x96\x92" },
+    { 30276, "\xe9\x9b\x9e" },
+    { 30277, "\xe9\xa4\x83" },
+    { 30278, "\xe9\xa5\x80" },
+    { 30279, "\xe9\xab\x99" },
+    { 30280, "\xe9\xaf\x96" },
+    { 30281, "\xe9\xb7\x97" },
+    { 30282, "\xe9\xba\xb4" },
+    { 30283, "\xe9\xba\xb5" },
+    { 31265, "\xe2\x9b\x8c" },
+    { 31266, "\xe2\x9b\x8d" },
+    { 31267, "\xe2\x9d\x97" },
+    { 31268, "\xe2\x9b\x8f" },
+    { 31269, "\xe2\x9b\x90" },
+    { 31270, "\xe2\x9b\x91" },
+    { 31272, "\xe2\x9b\x92" },
+    { 31273, "\xe2\x9b\x95" },
+    { 31274, "\xe2\x9b\x93" },
+    { 31275, "\xe2\x9b\x94" },
+    { 31280, "\xf0\x9f\x85\xbf" },
+    { 31281, "\xf0\x9f\x86\x8a" },
+    { 31284, "\xe2\x9b\x96" },
+    { 31285, "\xe2\x9b\x97" },
+    { 31286, "\xe2\x9b\x98" },
+    { 31287, "\xe2\x9b\x99" },
+    { 31288, "\xe2\x9b\x9a" },
+    { 31289, "\xe2\x9b\x9b" },
+    { 31290, "\xe2\x9b\x9c" },
+    { 31291, "\xe2\x9b\x9d" },
+    { 31292, "\xe2\x9b\x9e" },
+    { 31293, "\xe2\x9b\x9f" },
+    { 31294, "\xe2\x9b\xa0" },
+    { 31295, "\xe2\x9b\xa1" },
+    { 31296, "\xe2\xad\x95" },
+    { 31297, "\xe3\x89\x88" },
+    { 31298, "\xe3\x89\x89" },
+    { 31299, "\xe3\x89\x8a" },
+    { 31300, "\xe3\x89\x8b" },
+    { 31301, "\xe3\x89\x8c" },
+    { 31302, "\xe3\x89\x8d" },
+    { 31303, "\xe3\x89\x8e" },
+    { 31304, "\xe3\x89\x8f" },
+    { 31309, "\xe2\x92\x91" },
+    { 31310, "\xe2\x92\x92" },
+    { 31311, "\xe2\x92\x93" },
+    { 31312, "\xf0\x9f\x85\x8a" },
+    { 31313, "\xf0\x9f\x85\x8c" },
+    { 31314, "\xf0\x9f\x84\xbf" },
+    { 31315, "\xf0\x9f\x85\x86" },
+    { 31316, "\xf0\x9f\x85\x8b" },
+    { 31317, "\xf0\x9f\x88\x90" },
+    { 31318, "\xf0\x9f\x88\x91" },
+    { 31319, "\xf0\x9f\x88\x92" },
+    { 31320, "\xf0\x9f\x88\x93" },
+    { 31321, "\xf0\x9f\x85\x82" },
+    { 31322, "\xf0\x9f\x88\x94" },
+    { 31323, "\xf0\x9f\x88\x95" },
+    { 31324, "\xf0\x9f\x88\x96" },
+    { 31325, "\xf0\x9f\x85\x8d" },
+    { 31326, "\xf0\x9f\x84\xb1" },
+    { 31327, "\xf0\x9f\x84\xbd" },
+    { 31328, "\xe2\xac\x9b" },
+    { 31329, "\xe2\xac\xa4" },
+    { 31330, "\xf0\x9f\x88\x97" },
+    { 31331, "\xf0\x9f\x88\x98" },
+    { 31332, "\xf0\x9f\x88\x99" },
+    { 31333, "\xf0\x9f\x88\x9a" },
+    { 31334, "\xf0\x9f\x88\x9b" },
+    { 31335, "\xe2\x9a\xbf" },
+    { 31336, "\xf0\x9f\x88\x9c" },
+    { 31337, "\xf0\x9f\x88\x9d" },
+    { 31338, "\xf0\x9f\x88\x9e" },
+    { 31339, "\xf0\x9f\x88\x9f" },
+    { 31340, "\xf0\x9f\x88\xa0" },
+    { 31341, "\xf0\x9f\x88\xa1" },
+    { 31342, "\xf0\x9f\x88\xa2" },
+    { 31343, "\xf0\x9f\x88\xa3" },
+    { 31344, "\xf0\x9f\x88\xa4" },
+    { 31345, "\xf0\x9f\x88\xa5" },
+    { 31346, "\xf0\x9f\x85\x8e" },
+    { 31347, "\xe3\x8a\x99" },
+    { 31348, "\xf0\x9f\x88\x80" },
+    { 31521, "\xe2\x9b\xa3" },
+    { 31522, "\xe2\xad\x96" },
+    { 31523, "\xe2\xad\x97" },
+    { 31524, "\xe2\xad\x98" },
+    { 31525, "\xe2\xad\x99" },
+    { 31526, "\xe2\x98\x93" },
+    { 31527, "\xe3\x8a\x8b" },
+    { 31528, "\xe3\x80\x92" },
+    { 31529, "\xe2\x9b\xa8" },
+    { 31530, "\xe3\x89\x86" },
+    { 31531, "\xe3\x89\x85" },
+    { 31532, "\xe2\x9b\xa9" },
+    { 31533, "\xe0\xbf\x96" },
+    { 31534, "\xe2\x9b\xaa" },
+    { 31535, "\xe2\x9b\xab" },
+    { 31536, "\xe2\x9b\xac" },
+    { 31537, "\xe2\x99\xa8" },
+    { 31538, "\xe2\x9b\xad" },
+    { 31539, "\xe2\x9b\xae" },
+    { 31540, "\xe2\x9b\xaf" },
+    { 31541, "\xe2\x9a\x93" },
+    { 31542, "\xe2\x9c\x88" },
+    { 31543, "\xe2\x9b\xb0" },
+    { 31544, "\xe2\x9b\xb1" },
+    { 31545, "\xe2\x9b\xb2" },
+    { 31546, "\xe2\x9b\xb3" },
+    { 31547, "\xe2\x9b\xb4" },
+    { 31548, "\xe2\x9b\xb5" },
+    { 31549, "\xf0\x9f\x85\x97" },
+    { 31550, "\xe2\x92\xb9" },
+    { 31551, "\xe2\x93\x88" },
+    { 31552, "\xe2\x9b\xb6" },
+    { 31553, "\xf0\x9f\x85\x9f" },
+    { 31554, "\xf0\x9f\x86\x8b" },
+    { 31555, "\xf0\x9f\x86\x8d" },
+    { 31556, "\xf0\x9f\x86\x8c" },
+    { 31557, "\xf0\x9f\x85\xb9" },
+    { 31558, "\xe2\x9b\xb7" },
+    { 31559, "\xe2\x9b\xb8" },
+    { 31560, "\xe2\x9b\xb9" },
+    { 31561, "\xe2\x9b\xba" },
+    { 31562, "\xf0\x9f\x85\xbb" },
+    { 31563, "\xe2\x98\x8e" },
+    { 31564, "\xe2\x9b\xbb" },
+    { 31565, "\xe2\x9b\xbc" },
+    { 31566, "\xe2\x9b\xbd" },
+    { 31567, "\xe2\x9b\xbe" },
+    { 31568, "\xf0\x9f\x85\xbc" },
+    { 31569, "\xe2\x9b\xbf" },
+    { 31777, "\xe2\x9e\xa1" },
+    { 31778, "\xe2\xac\x85" },
+    { 31779, "\xe2\xac\x86" },
+    { 31780, "\xe2\xac\x87" },
+    { 31781, "\xe2\xac\xaf" },
+    { 31782, "\xe2\xac\xae" },
+    { 31783, "\xe5\xb9\xb4" },
+    { 31784, "\xe6\x9c\x88" },
+    { 31785, "\xe6\x97\xa5" },
+    { 31786, "\xe5\x86\x86" },
+    { 31787, "\xe3\x8e\xa1" },
+    { 31788, "\xe3\x8e\xa5" },
+    { 31789, "\xe3\x8e\x9d" },
+    { 31790, "\xe3\x8e\xa0" },
+    { 31791, "\xe3\x8e\xa4" },
+    { 31792, "\xf0\x9f\x84\x80" },
+    { 31793, "\xe2\x92\x88" },
+    { 31794, "\xe2\x92\x89" },
+    { 31795, "\xe2\x92\x8a" },
+    { 31796, "\xe2\x92\x8b" },
+    { 31797, "\xe2\x92\x8c" },
+    { 31798, "\xe2\x92\x8d" },
+    { 31799, "\xe2\x92\x8e" },
+    { 31800, "\xe2\x92\x8f" },
+    { 31801, "\xe2\x92\x90" },
+    { 31802, "\xee\x8a\x90" },
+    { 31803, "\xee\x8a\x91" },
+    { 31804, "\xee\x8a\x92" },
+    { 31805, "\xee\x8a\x93" },
+    { 31806, "\xee\x8a\x94" },
+    { 31807, "\xee\x8a\x95" },
+    { 31808, "\xf0\x9f\x84\x81" },
+    { 31809, "\xf0\x9f\x84\x82" },
+    { 31810, "\xf0\x9f\x84\x83" },
+    { 31811, "\xf0\x9f\x84\x84" },
+    { 31812, "\xf0\x9f\x84\x85" },
+    { 31813, "\xf0\x9f\x84\x86" },
+    { 31814, "\xf0\x9f\x84\x87" },
+    { 31815, "\xf0\x9f\x84\x88" },
+    { 31816, "\xf0\x9f\x84\x89" },
+    { 31817, "\xf0\x9f\x84\x8a" },
+    { 31818, "\xe3\x88\xb3" },
+    { 31819, "\xe3\x88\xb6" },
+    { 31820, "\xe3\x88\xb2" },
+    { 31821, "\xe3\x88\xb1" },
+    { 31822, "\xe3\x88\xb9" },
+    { 31823, "\xe3\x89\x84" },
+    { 31824, "\xe2\x96\xb6" },
+    { 31825, "\xe2\x97\x80" },
+    { 31826, "\xe3\x80\x96" },
+    { 31827, "\xe3\x80\x97" },
+    { 31828, "\xe2\x9f\x90" },
+    { 31829, "\xc2\xb2" },
+    { 31830, "\xc2\xb3" },
+    { 31831, "\xf0\x9f\x84\xad" },
+    { 31832, "\xee\x8a\xa5" },
+    { 31833, "\xee\x8a\xa6" },
+    { 31834, "\xee\x8a\xa7" },
+    { 31835, "\xee\x8a\xa8" },
+    { 31836, "\xee\x8a\xa9" },
+    { 31837, "\xee\x8a\xaa" },
+    { 31838, "\xee\x8a\xab" },
+    { 31839, "\xee\x8a\xac" },
+    { 31840, "\xee\x8a\xad" },
+    { 31841, "\xee\x8a\xae" },
+    { 31842, "\xee\x8a\xaf" },
+    { 31843, "\xee\x8a\xb0" },
+    { 31844, "\xee\x8a\xb1" },
+    { 31845, "\xee\x8a\xb2" },
+    { 31846, "\xee\x8a\xb3" },
+    { 31847, "\xee\x8a\xb4" },
+    { 31848, "\xee\x8a\xb5" },
+    { 31849, "\xee\x8a\xb6" },
+    { 31850, "\xee\x8a\xb7" },
+    { 31851, "\xee\x8a\xb8" },
+    { 31852, "\xee\x8a\xb9" },
+    { 31853, "\xee\x8a\xba" },
+    { 31854, "\xee\x8a\xbb" },
+    { 31855, "\xee\x8a\xbc" },
+    { 31856, "\xee\x8a\xbd" },
+    { 31857, "\xee\x8a\xbe" },
+    { 31858, "\xee\x8a\xbf" },
+    { 31859, "\xee\x8b\x80" },
+    { 31860, "\xee\x8b\x81" },
+    { 31861, "\xee\x8b\x82" },
+    { 31862, "\xf0\x9f\x84\xac" },
+    { 31863, "\xf0\x9f\x84\xab" },
+    { 31864, "\xe3\x89\x87" },
+    { 31865, "\xf0\x9f\x86\x90" },
+    { 31866, "\xf0\x9f\x88\xa6" },
+    { 31867, "\xe2\x84\xbb" },
+    { 32033, "\xe3\x88\xaa" },
+    { 32034, "\xe3\x88\xab" },
+    { 32035, "\xe3\x88\xac" },
+    { 32036, "\xe3\x88\xad" },
+    { 32037, "\xe3\x88\xae" },
+    { 32038, "\xe3\x88\xaf" },
+    { 32039, "\xe3\x88\xb0" },
+    { 32040, "\xe3\x88\xb7" },
+    { 32041, "\xe3\x8d\xbe" },
+    { 32042, "\xe3\x8d\xbd" },
+    { 32043, "\xe3\x8d\xbc" },
+    { 32044, "\xe3\x8d\xbb" },
+    { 32045, "\xe2\x84\x96" },
+    { 32046, "\xe2\x84\xa1" },
+    { 32047, "\xe3\x80\xb6" },
+    { 32048, "\xe2\x9a\xbe" },
+    { 32049, "\xf0\x9f\x89\x80" },
+    { 32050, "\xf0\x9f\x89\x81" },
+    { 32051, "\xf0\x9f\x89\x82" },
+    { 32052, "\xf0\x9f\x89\x83" },
+    { 32053, "\xf0\x9f\x89\x84" },
+    { 32054, "\xf0\x9f\x89\x85" },
+    { 32055, "\xf0\x9f\x89\x86" },
+    { 32056, "\xf0\x9f\x89\x87" },
+    { 32057, "\xf0\x9f\x89\x88" },
+    { 32058, "\xf0\x9f\x84\xaa" },
+    { 32059, "\xf0\x9f\x88\xa7" },
+    { 32060, "\xf0\x9f\x88\xa8" },
+    { 32061, "\xf0\x9f\x88\xa9" },
+    { 32062, "\xf0\x9f\x88\x94" },
+    { 32063, "\xf0\x9f\x88\xaa" },
+    { 32064, "\xf0\x9f\x88\xab" },
+    { 32065, "\xf0\x9f\x88\xac" },
+    { 32066, "\xf0\x9f\x88\xad" },
+    { 32067, "\xf0\x9f\x88\xae" },
+    { 32068, "\xf0\x9f\x88\xaf" },
+    { 32069, "\xf0\x9f\x88\xb0" },
+    { 32070, "\xf0\x9f\x88\xb1" },
+    { 32071, "\xe2\x84\x93" },
+    { 32072, "\xe3\x8e\x8f" },
+    { 32073, "\xe3\x8e\x90" },
+    { 32074, "\xe3\x8f\x8a" },
+    { 32075, "\xe3\x8e\x9e" },
+    { 32076, "\xe3\x8e\xa2" },
+    { 32077, "\xe3\x8d\xb1" },
+    { 32080, "\xc2\xbd" },
+    { 32081, "\xe2\x86\x89" },
+    { 32082, "\xe2\x85\x93" },
+    { 32083, "\xe2\x85\x94" },
+    { 32084, "\xc2\xbc" },
+    { 32085, "\xc2\xbe" },
+    { 32086, "\xe2\x85\x95" },
+    { 32087, "\xe2\x85\x96" },
+    { 32088, "\xe2\x85\x97" },
+    { 32089, "\xe2\x85\x98" },
+    { 32090, "\xe2\x85\x99" },
+    { 32091, "\xe2\x85\x9a" },
+    { 32092, "\xe2\x85\x90" },
+    { 32093, "\xe2\x85\x9b" },
+    { 32094, "\xe2\x85\x91" },
+    { 32095, "\xe2\x85\x92" },
+    { 32096, "\xe2\x98\x80" },
+    { 32097, "\xe2\x98\x81" },
+    { 32098, "\xe2\x98\x82" },
+    { 32099, "\xe2\x9b\x84" },
+    { 32100, "\xe2\x98\x96" },
+    { 32101, "\xe2\x98\x97" },
+    { 32102, "\xe2\x9b\x89" },
+    { 32103, "\xe2\x9b\x8a" },
+    { 32104, "\xe2\x99\xa6" },
+    { 32105, "\xe2\x99\xa5" },
+    { 32106, "\xe2\x99\xa3" },
+    { 32107, "\xe2\x99\xa0" },
+    { 32108, "\xe2\x9b\x8b" },
+    { 32109, "\xe2\xa8\x80" },
+    { 32110, "\xe2\x80\xbc" },
+    { 32111, "\xe2\x81\x89" },
+    { 32112, "\xe2\x9b\x85" },
+    { 32113, "\xe2\x98\x94" },
+    { 32114, "\xe2\x9b\x86" },
+    { 32115, "\xe2\x98\x83" },
+    { 32116, "\xe2\x9b\x87" },
+    { 32117, "\xe2\x9a\xa1" },
+    { 32118, "\xe2\x9b\x88" },
+    { 32120, "\xe2\x9a\x9e" },
+    { 32121, "\xe2\x9a\x9f" },
+    { 32122, "\xe2\x99\xac" },
+    { 32123, "\xe2\x98\x8e" },
+    { 32289, "\xe2\x85\xa0" },
+    { 32290, "\xe2\x85\xa1" },
+    { 32291, "\xe2\x85\xa2" },
+    { 32292, "\xe2\x85\xa3" },
+    { 32293, "\xe2\x85\xa4" },
+    { 32294, "\xe2\x85\xa5" },
+    { 32295, "\xe2\x85\xa6" },
+    { 32296, "\xe2\x85\xa7" },
+    { 32297, "\xe2\x85\xa8" },
+    { 32298, "\xe2\x85\xa9" },
+    { 32299, "\xe2\x85\xaa" },
+    { 32300, "\xe2\x85\xab" },
+    { 32301, "\xe2\x91\xb0" },
+    { 32302, "\xe2\x91\xb1" },
+    { 32303, "\xe2\x91\xb2" },
+    { 32304, "\xe2\x91\xb3" },
+    { 32305, "\xe2\x91\xb4" },
+    { 32306, "\xe2\x91\xb5" },
+    { 32307, "\xe2\x91\xb6" },
+    { 32308, "\xe2\x91\xb7" },
+    { 32309, "\xe2\x91\xb8" },
+    { 32310, "\xe2\x91\xb9" },
+    { 32311, "\xe2\x91\xba" },
+    { 32312, "\xe2\x91\xbb" },
+    { 32313, "\xe2\x91\xbc" },
+    { 32314, "\xe2\x91\xbd" },
+    { 32315, "\xe2\x91\xbe" },
+    { 32316, "\xe2\x91\xbf" },
+    { 32317, "\xe3\x89\x91" },
+    { 32318, "\xe3\x89\x92" },
+    { 32319, "\xe3\x89\x93" },
+    { 32320, "\xe3\x89\x94" },
+    { 32321, "\xf0\x9f\x84\x90" },
+    { 32322, "\xf0\x9f\x84\x91" },
+    { 32323, "\xf0\x9f\x84\x92" },
+    { 32324, "\xf0\x9f\x84\x93" },
+    { 32325, "\xf0\x9f\x84\x94" },
+    { 32326, "\xf0\x9f\x84\x95" },
+    { 32327, "\xf0\x9f\x84\x96" },
+    { 32328, "\xf0\x9f\x84\x97" },
+    { 32329, "\xf0\x9f\x84\x98" },
+    { 32330, "\xf0\x9f\x84\x99" },
+    { 32331, "\xf0\x9f\x84\x9a" },
+    { 32332, "\xf0\x9f\x84\x9b" },
+    { 32333, "\xf0\x9f\x84\x9c" },
+    { 32334, "\xf0\x9f\x84\x9d" },
+    { 32335, "\xf0\x9f\x84\x9e" },
+    { 32336, "\xf0\x9f\x84\x9f" },
+    { 32337, "\xf0\x9f\x84\xa0" },
+    { 32338, "\xf0\x9f\x84\xa1" },
+    { 32339, "\xf0\x9f\x84\xa2" },
+    { 32340, "\xf0\x9f\x84\xa3" },
+    { 32341, "\xf0\x9f\x84\xa4" },
+    { 32342, "\xf0\x9f\x84\xa5" },
+    { 32343, "\xf0\x9f\x84\xa6" },
+    { 32344, "\xf0\x9f\x84\xa7" },
+    { 32345, "\xf0\x9f\x84\xa8" },
+    { 32346, "\xf0\x9f\x84\xa9" },
+    { 32347, "\xe3\x89\x95" },
+    { 32348, "\xe3\x89\x96" },
+    { 32349, "\xe3\x89\x97" },
+    { 32350, "\xe3\x89\x98" },
+    { 32351, "\xe3\x89\x99" },
+    { 32352, "\xe3\x89\x9a" },
+    { 32353, "\xe2\x91\xa0" },
+    { 32354, "\xe2\x91\xa1" },
+    { 32355, "\xe2\x91\xa2" },
+    { 32356, "\xe2\x91\xa3" },
+    { 32357, "\xe2\x91\xa4" },
+    { 32358, "\xe2\x91\xa5" },
+    { 32359, "\xe2\x91\xa6" },
+    { 32360, "\xe2\x91\xa7" },
+    { 32361, "\xe2\x91\xa8" },
+    { 32362, "\xe2\x91\xa9" },
+    { 32363, "\xe2\x91\xaa" },
+    { 32364, "\xe2\x91\xab" },
+    { 32365, "\xe2\x91\xac" },
+    { 32366, "\xe2\x91\xad" },
+    { 32367, "\xe2\x91\xae" },
+    { 32368, "\xe2\x91\xaf" },
+    { 32369, "\xe2\x9d\xb6" },
+    { 32370, "\xe2\x9d\xb7" },
+    { 32371, "\xe2\x9d\xb8" },
+    { 32372, "\xe2\x9d\xb9" },
+    { 32373, "\xe2\x9d\xba" },
+    { 32374, "\xe2\x9d\xbb" },
+    { 32375, "\xe2\x9d\xbc" },
+    { 32376, "\xe2\x9d\xbd" },
+    { 32377, "\xe2\x9d\xbe" },
+    { 32378, "\xe2\x9d\xbf" },
+    { 32379, "\xe2\x93\xab" },
+    { 32380, "\xe2\x93\xac" },
+    { 32381, "\xe3\x89\x9b" },
+};
+static const size_t arib_gaiji_map_count = 531;
diff --git a/modules/demux/mpeg/ts_arib.c b/modules/demux/mpeg/ts_arib.c
index 1190a9193f..3f4f221262 100644
--- a/modules/demux/mpeg/ts_arib.c
+++ b/modules/demux/mpeg/ts_arib.c
@@ -208,3 +208,451 @@ ts_arib_logo_dr_t * ts_arib_logo_dr_Decode( const uint8_t *p_data, size_t i_data
     ts_arib_logo_dr_Delete( p_dr );
     return NULL;
 }
+
+/*
+ * SPDX-FileCopyrightText: 2015-2016 rndomhack
+ * SPDX-License-Identifier: MIT
+ * https://github.com/Chinachu/node-aribts
+ */
+
+#include "arib_tables.h"
+#include <vlc_charset.h>
+#include <vlc_memstream.h>
+
+typedef struct
+{
+    uint8_t  graphic[4];      /* Character set designated to G0..G3 */
+    uint8_t  graphic_mode[4]; /* 0: Graphic, 1: DRCS, 2: Other */
+    uint8_t  graphic_byte[4]; /* Bytes per character (1 or 2) */
+    uint8_t  graphic_l;       /* Set invoked into GL */
+    uint8_t  graphic_r;       /* Set invoked into GR */
+} arib_parser_t;
+
+/* Character Set IDs (subset of charCode in node-aribts) */
+#define CS_KANJI                0x42
+#define CS_ASCII                0x4A
+#define CS_HIRAGANA             0x30
+#define CS_KATAKANA             0x31
+#define CS_MOSAIC_A             0x32
+#define CS_MOSAIC_B             0x33
+#define CS_MOSAIC_C             0x34
+#define CS_MOSAIC_D             0x35
+#define CS_PROP_ASCII           0x36
+#define CS_PROP_HIRAGANA        0x37
+#define CS_PROP_KATAKANA        0x38
+#define CS_JIS_KANJI_1          0x39
+#define CS_JIS_KANJI_2          0x3A
+#define CS_SYMBOL               0x3B
+#define CS_JIS_X0201_KATAKANA   0x49
+
+/* Mode */
+#define MODE_GRAPHIC 0
+#define MODE_DRCS    1
+#define MODE_OTHER   2
+
+static int cmp_u8_sjis( const void *key, const void *elem )
+{
+    const uint8_t k = *(const uint8_t *)key;
+    const arib_map_sjis_t *e = (const arib_map_sjis_t *)elem;
+    return (int)k - (int)e->key;
+}
+
+static int cmp_u16_str( const void *key, const void *elem )
+{
+    const uint16_t k = *(const uint16_t *)key;
+    const arib_map_str_t *e = (const arib_map_str_t *)elem;
+    return (int)k - (int)e->key;
+}
+
+static void arib_buf_append( uint8_t **pp_buf, size_t *pi_buf, size_t *pi_alloc,
+                             uint8_t b1, uint8_t b2 )
+{
+    if( *pi_buf + 2 > *pi_alloc )
+    {
+        size_t i_new = *pi_alloc + 128;
+        uint8_t *p_new = realloc( *pp_buf, i_new );
+        if( !p_new ) return;
+        *pp_buf = p_new;
+        *pi_alloc = i_new;
+    }
+    (*pp_buf)[(*pi_buf)++] = b1;
+    if( b2 ) (*pp_buf)[(*pi_buf)++] = b2;
+}
+
+static void arib_flush( struct vlc_memstream *p_stream, uint8_t **pp_buf, size_t *pi_buf )
+{
+    if( *pi_buf > 0 )
+    {
+        char *psz = FromCharset( "Shift_JIS", *pp_buf, *pi_buf );
+        if( psz )
+        {
+            vlc_memstream_puts( p_stream, psz );
+            free( psz );
+        }
+        *pi_buf = 0;
+    }
+}
+
+static void get_sjis_kanji( uint8_t b1, uint8_t b2, uint8_t res[2] )
+{
+    uint8_t row = (b1 < 0x5F) ? 0x70 : 0xB0;
+    uint8_t cell = (b1 & 1) ? ((b2 > 0x5F) ? 0x20 : 0x1F) : 0x7E;
+
+    res[0] = (((b1 + 1) >> 1) + row) & 0xFF;
+    res[1] = (b2 + cell) & 0xFF;
+}
+
+static void ts_arib_process_gl( arib_parser_t *p_ctx, uint8_t c,
+                                const uint8_t *p_in, size_t i_in, size_t *pi,
+                                struct vlc_memstream *p_stream,
+                                uint8_t **pp_sjis, size_t *pi_sjis, size_t *pi_sjis_alloc,
+                                bool b_graphic_normal )
+{
+    uint8_t set_idx = p_ctx->graphic_l;
+    if( p_ctx->graphic_mode[set_idx] != MODE_GRAPHIC )
+    {
+        /* Invalid mode for GL, skip char(s) */
+        if( p_ctx->graphic_byte[set_idx] == 2 && *pi < i_in ) (*pi)++;
+    }
+    else
+    {
+        uint8_t cs = p_ctx->graphic[set_idx];
+
+        if( p_ctx->graphic_byte[set_idx] == 2 )
+        {
+             /* 2-byte GL */
+             uint8_t c2 = (*pi < i_in) ? p_in[(*pi)++] : 0;
+             if( !c2 ) return;
+
+             /* Kanji / Gaiji Handling */
+             uint16_t code = (c << 8) | c2;
+
+             arib_map_str_t *p_map = bsearch( &code, arib_gaiji_map, arib_gaiji_map_count,
+                                              sizeof(arib_map_str_t), cmp_u16_str );
+             if( p_map )
+             {
+                 arib_flush( p_stream, pp_sjis, pi_sjis );
+                 vlc_memstream_puts( p_stream, p_map->val );
+             }
+             else
+             {
+                 uint8_t sjis[2];
+                 get_sjis_kanji( c, c2, sjis );
+                 arib_buf_append( pp_sjis, pi_sjis, pi_sjis_alloc, sjis[0], sjis[1] );
+             }
+        }
+        else
+        {
+            /* 1-byte GL */
+            const arib_map_sjis_t *p_el = NULL;
+            uint8_t val[2] = {0};
+
+            if( cs == CS_ASCII || cs == CS_PROP_ASCII || cs == CS_JIS_X0201_KATAKANA )
+            {
+                if( b_graphic_normal )
+                     p_el = bsearch( &c, arib_ascii_map, arib_ascii_map_count, sizeof(arib_map_sjis_t), cmp_u8_sjis );
+                else
+                     val[0] = c;
+            }
+            else if( cs == CS_HIRAGANA || cs == CS_PROP_HIRAGANA )
+            {
+                p_el = bsearch( &c, arib_hiragana_map, arib_hiragana_map_count, sizeof(arib_map_sjis_t), cmp_u8_sjis );
+            }
+            else if( cs == CS_KATAKANA || cs == CS_PROP_KATAKANA )
+            {
+                p_el = bsearch( &c, arib_katakana_map, arib_katakana_map_count, sizeof(arib_map_sjis_t), cmp_u8_sjis );
+            }
+
+            if( p_el )
+            {
+                val[0] = p_el->val[0];
+                val[1] = p_el->val[1];
+            }
+            else if( !val[0] && b_graphic_normal && cs == CS_ASCII )
+            {
+                val[0] = c;
+            }
+
+            arib_buf_append( pp_sjis, pi_sjis, pi_sjis_alloc, val[0], val[1] );
+        }
+    }
+}
+
+char * ts_arib_Decode( const uint8_t *p_in, size_t i_in )
+{
+    if( !p_in || !i_in ) return NULL;
+
+    struct vlc_memstream stream;
+    if( vlc_memstream_open( &stream ) )
+        return NULL;
+
+    arib_parser_t ctx;
+    /* Default init similar to node-aribts */
+    ctx.graphic[0] = CS_KANJI;
+    ctx.graphic[1] = CS_ASCII;
+    ctx.graphic[2] = CS_HIRAGANA;
+    ctx.graphic[3] = CS_KATAKANA;
+    ctx.graphic_mode[0] = MODE_GRAPHIC;
+    ctx.graphic_mode[1] = MODE_GRAPHIC;
+    ctx.graphic_mode[2] = MODE_GRAPHIC;
+    ctx.graphic_mode[3] = MODE_GRAPHIC;
+    ctx.graphic_byte[0] = 2;
+    ctx.graphic_byte[1] = 1;
+    ctx.graphic_byte[2] = 1;
+    ctx.graphic_byte[3] = 1;
+    ctx.graphic_l = 0;
+    ctx.graphic_r = 2;
+    bool b_graphic_normal = true; /* For handling 1-byte charsets vs MSZ/NSZ? node-aribts uses graphicNormal */
+
+    uint8_t *p_sjis = NULL;
+    size_t i_sjis = 0;
+    size_t i_sjis_alloc = 0;
+
+    size_t i = 0;
+    while( i < i_in )
+    {
+        uint8_t c = p_in[i++];
+
+        if( c <= 0x20 ) /* C0 */
+        {
+            switch( c )
+            {
+                case 0x0D: /* APR (CR) */
+                    arib_buf_append( &p_sjis, &i_sjis, &i_sjis_alloc, 0x0D, 0x0A );
+                    break;
+                case 0x0E: /* LS1 */
+                    ctx.graphic_l = 1;
+                    break;
+                case 0x0F: /* LS0 */
+                    ctx.graphic_l = 0;
+                    break;
+                case 0x16: /* PAPF */
+                    if( i < i_in ) i++;
+                    break;
+                case 0x19: /* SS2 */
+                {
+                    uint8_t saved_l = ctx.graphic_l;
+                    ctx.graphic_l = 2;
+                    if( i < i_in )
+                    {
+                        uint8_t next_c = p_in[i];
+                        if ( next_c > 0x20 && next_c <= 0x7E )
+                        {
+                            i++;
+                            ts_arib_process_gl( &ctx, next_c, p_in, i_in, &i, &stream,
+                                                &p_sjis, &i_sjis, &i_sjis_alloc, b_graphic_normal );
+                        }
+                    }
+                    ctx.graphic_l = saved_l;
+                }
+                    break;
+                case 0x1C: /* APS */
+                    if( i + 1 < i_in ) i += 2;
+                    else i = i_in;
+                    break;
+                case 0x1D: /* SS3 */
+                {
+                    uint8_t saved_l = ctx.graphic_l;
+                    ctx.graphic_l = 3;
+                    if( i < i_in )
+                    {
+                        uint8_t next_c = p_in[i];
+                        if ( next_c > 0x20 && next_c <= 0x7E )
+                        {
+                            i++;
+                            ts_arib_process_gl( &ctx, next_c, p_in, i_in, &i, &stream,
+                                                &p_sjis, &i_sjis, &i_sjis_alloc, b_graphic_normal );
+                        }
+                    }
+                    ctx.graphic_l = saved_l;
+                }
+                    break;
+                case 0x1B: /* ESC */
+                    if( i < i_in )
+                    {
+                        uint8_t c2 = p_in[i++];
+                        if( c2 == 0x24 ) /* Invoke MB */
+                        {
+                            if ( i < i_in )
+                            {
+                                uint8_t c3 = p_in[i++];
+                                uint8_t set = 0;
+                                if( c3 >= 0x28 && c3 <= 0x2B ) /* G0..G3 $ ( */
+                                {
+                                    set = c3 - 0x28;
+                                    if( i < i_in ) c3 = p_in[i++];
+                                }
+                                else
+                                {
+                                    set = 0; /* G0 $ */
+                                }
+
+                                /* Check for DRCS/Other 4th byte */
+                                if( c3 == 0x20 || c3 == 0x28 )
+                                {
+                                    /* Read one more byte */
+                                    if( i < i_in ) c3 = p_in[i++];
+                                }
+
+                                /* Final byte c3 defines the charset */
+                                if( c2 == 0x24 ) /* Multi-byte */
+                                {
+                                    ctx.graphic[set] = c3;
+                                    ctx.graphic_mode[set] = (c3 == 0x20) ? MODE_DRCS : MODE_GRAPHIC; /* Simplification */
+                                    ctx.graphic_byte[set] = 2;
+                                }
+                            }
+                        }
+                        else if( c2 >= 0x28 && c2 <= 0x2B ) /* Invoke SB G0..G3 */
+                        {
+                             uint8_t set = c2 - 0x28;
+                             if( i < i_in )
+                             {
+                                 uint8_t c3 = p_in[i++];
+                                 /* Check for DRCS/Other 4th byte */
+                                 if( c3 == 0x20 || c3 == 0x28 )
+                                 {
+                                     /* Read one more byte */
+                                     if( i < i_in ) c3 = p_in[i++];
+                                 }
+
+                                 ctx.graphic[set] = c3;
+                                 ctx.graphic_mode[set] = (c3 == 0x20) ? MODE_DRCS : MODE_GRAPHIC;
+                                 ctx.graphic_byte[set] = 1;
+
+                                 if( c3 == 0x20 ) /* SPC */
+                                     arib_buf_append( &p_sjis, &i_sjis, &i_sjis_alloc, 0x81, 0x40 );
+                             }
+                        }
+                        else if( c2 == 0x6E ) ctx.graphic_l = 2; /* LS2 */
+                        else if( c2 == 0x6F ) ctx.graphic_l = 3; /* LS3 */
+                        else if( c2 == 0x7E ) ctx.graphic_r = 1; /* LS1R */
+                        else if( c2 == 0x7D ) ctx.graphic_r = 2; /* LS2R */
+                        else if( c2 == 0x7C ) ctx.graphic_r = 3; /* LS3R */
+                    }
+                    break;
+                case 0x20: /* SP */
+                    arib_buf_append( &p_sjis, &i_sjis, &i_sjis_alloc,
+                                     b_graphic_normal ? 0x81 : 0x20,
+                                     b_graphic_normal ? 0x40 : 0x00 );
+                    break;
+            }
+        }
+        else if( c <= 0x7E ) /* GL */
+        {
+            ts_arib_process_gl( &ctx, c, p_in, i_in, &i, &stream,
+                                &p_sjis, &i_sjis, &i_sjis_alloc, b_graphic_normal );
+        }
+        else if( c <= 0xA0 ) /* C1 */
+        {
+             switch( c )
+             {
+                 case 0x89: b_graphic_normal = false; break; /* MSZ */
+                 case 0x8A: b_graphic_normal = true; break; /* NSZ */
+                 case 0x8B: /* SZX */
+                     if( i < i_in ) i++;
+                     break;
+                 case 0x90: /* COL */
+                     if( i < i_in )
+                     {
+                         uint8_t p1 = p_in[i++];
+                         if( p1 == 0x20 && i < i_in ) i++;
+                     }
+                     break;
+                 case 0x95: /* MACRO */
+                     while( i < i_in && p_in[i] != 0x4F ) i++;
+                     if( i < i_in ) i++;
+                     break;
+                 case 0x9D: /* TIME */
+                 {
+                     if( i < i_in )
+                     {
+                         uint8_t p1 = p_in[i++];
+                         if( p1 == 0x20 )
+                         {
+                             if( i < i_in ) i++;
+                         }
+                         else if( p1 == 0x28 )
+                         {
+                              if( i < i_in ) i++;
+                         }
+                     }
+                     break;
+                 }
+             }
+        }
+        else if( c != 0xFF ) /* GR */
+        {
+            /* GR Logic, mask 0x7F and use graphic_r */
+             uint8_t set_idx = ctx.graphic_r;
+            if( ctx.graphic_mode[set_idx] != MODE_GRAPHIC )
+            {
+                if( ctx.graphic_byte[set_idx] == 2 && i < i_in ) i++;
+            }
+            else
+            {
+                uint8_t c7 = c & 0x7F;
+                uint8_t cs = ctx.graphic[set_idx];
+
+                if( ctx.graphic_byte[set_idx] == 2 )
+                {
+                     uint8_t c2 = (i < i_in) ? (p_in[i++] & 0x7F) : 0;
+                     if( !c2 ) break;
+                     uint16_t code = (c7 << 8) | c2;
+
+                      arib_map_str_t *p_map = bsearch( &code, arib_gaiji_map, arib_gaiji_map_count,
+                                                      sizeof(arib_map_str_t), cmp_u16_str );
+                     if( p_map )
+                     {
+                         arib_flush( &stream, &p_sjis, &i_sjis );
+                         vlc_memstream_puts( &stream, p_map->val );
+                     }
+                     else
+                     {
+                         uint8_t sjis[2];
+                         get_sjis_kanji( c7, c2, sjis );
+                         arib_buf_append( &p_sjis, &i_sjis, &i_sjis_alloc, sjis[0], sjis[1] );
+                     }
+                }
+                else
+                {
+                    /* 1-byte GR */
+                    const arib_map_sjis_t *p_el = NULL;
+                    uint8_t val[2] = {0};
+
+                    if( cs == CS_ASCII || cs == CS_PROP_ASCII )
+                    {
+                         if( b_graphic_normal )
+                             p_el = bsearch( &c7, arib_ascii_map, arib_ascii_map_count, sizeof(arib_map_sjis_t), cmp_u8_sjis );
+                         else
+                             val[0] = c7;
+                    }
+                    else if( cs == CS_HIRAGANA || cs == CS_PROP_HIRAGANA )
+                         p_el = bsearch( &c7, arib_hiragana_map, arib_hiragana_map_count, sizeof(arib_map_sjis_t), cmp_u8_sjis );
+                    else if( cs == CS_KATAKANA || cs == CS_PROP_KATAKANA || cs == CS_JIS_X0201_KATAKANA )
+                         p_el = bsearch( &c7, arib_katakana_map, arib_katakana_map_count, sizeof(arib_map_sjis_t), cmp_u8_sjis );
+
+                    if( p_el )
+                    {
+                        val[0] = p_el->val[0];
+                        val[1] = p_el->val[1];
+                    }
+                    else if( !val[0] )
+                    {
+                        val[0] = c7; /* Default pass-through? */
+                    }
+
+                    arib_buf_append( &p_sjis, &i_sjis, &i_sjis_alloc, val[0], val[1] );
+                }
+            }
+        }
+    }
+
+    arib_flush( &stream, &p_sjis, &i_sjis );
+    free( p_sjis );
+
+    if( vlc_memstream_close( &stream ) )
+        return NULL;
+
+    return stream.ptr;
+}
diff --git a/modules/demux/mpeg/ts_arib.h b/modules/demux/mpeg/ts_arib.h
index 26502496a7..0a859adbec 100644
--- a/modules/demux/mpeg/ts_arib.h
+++ b/modules/demux/mpeg/ts_arib.h
@@ -51,4 +51,6 @@ void ts_arib_logo_dr_Delete( ts_arib_logo_dr_t * );
 bool ts_arib_inject_png_palette( const uint8_t *p_in, size_t i_in,
                                  uint8_t **pp_out, size_t *pi_out );
 
+char * ts_arib_Decode( const uint8_t *p_in, size_t i_in );
+
 #endif
diff --git a/modules/demux/mpeg/ts_si.c b/modules/demux/mpeg/ts_si.c
index 6a23825d59..e2ab37d13a 100644
--- a/modules/demux/mpeg/ts_si.c
+++ b/modules/demux/mpeg/ts_si.c
@@ -118,7 +118,10 @@ static char *EITConvertToUTF8( demux_t *p_demux,
         return psz_outstring;
     }
 #else
-    VLC_UNUSED(p_sys);
+    if ( p_sys->standard == TS_STANDARD_ARIB )
+    {
+        return ts_arib_Decode( psz_instring, i_length );
+    }
 #endif
     /* Deal with no longer broken providers (no switch byte
       but sending ISO_8859-1 instead of ISO_6937) without
-- 
2.39.1

